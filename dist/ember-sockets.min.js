/*! ember-sockets by Adam Timberlake created on 2014-01-26 */
!function(a,b,c){"use strict";a.EmberSockets=b.ObjectController.extend({host:"localhost",port:80,controllers:[],socket:null,init:function(){var a="http://%@:%@".fmt(b.get(this,"host"),b.get(this,"port")),d=c.connect(a);d.on("error",function(){throw"Unable to make a connection to the Socket.io server!"}),this.set("socket",d),d.on("connect",this._listen.bind(this))},emit:function(){var a=Array.prototype.slice.call(arguments),c=b.get(this,"socket");c.emit.apply(c,a)},_listen:function(){var a=b.get(this,"controllers"),c=this._getController.bind(this),d=[],e=b.EnumerableUtils,f=this,g=function(){var a=Array.prototype.slice.call(arguments);f._update.call(f,this,a)};e.forEach(a,function(a){var e=c(a),h=e.events;if(e){"object"==typeof e.events&&"function"==typeof e.events.connect&&e.events.connect.apply(e);for(var i in h)if(h.hasOwnProperty(i)){if(-1!==d.indexOf(i))continue;d.push(i),b.get(f,"socket").on(i,g.bind(i))}}})},_update:function(a,c){var d=b.get(this,"controllers"),e=0,f=this._getController.bind(this),g=b.EnumerableUtils.forEach;return b.run(function(){g(d,function(d){var h=f(d);if(h){var i=h.events[a];if(!i)return;if("function"==typeof i)return i.apply(h,c),e++,void 0;if(b.isArray(i))return g(i,function(a,d){b.set(h,a,c[d])}),e++,void 0;b.set(h,i,c),e++}})}),e},_getController:function(a){a="controller:%@".fmt(a);var b=this.container.lookup(a);return b&&"events"in b!=!1?b:!1}}),b.onLoad("Ember.Application",function(a){a.initializer({name:"sockets",initialize:function(a,b){b.register("socket:main",b.Socket,{singleton:!0}),b.inject("controller","socket","socket:main")}})})}(window,window.Ember,window.io);